;/*FB_PKG_DELIM*/

__d("LSStorage",["unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b,d,e){a=a.tableNames[b];b=a.indexes;a=a.primaryKeyIds;a=e==null?a:b[e];return a.reduceRight(function(a,b){if(d[b]!==void 0||e!=null)return{hd:d[b],tl:a};throw c("unrecoverableViolation")("primary key must be defined on object","messenger_web_product")},0)}function b(a,b){while(a!==0&&b!==0){if(a.hd!==b.hd&&!(Array.isArray(a.hd)&&Array.isArray(b.hd)&&a.hd.length===b.hd.length&&a.hd.every(function(a,c){return a===b.hd[c]})))return!1;a=a.tl;b=b.tl}return a===0&&b===0}g.searchKey=a;g.areKeysEqual=b}),98);
__d("ReStoreTransactionLock",["isPromise"],(function(a,b,c,d,e,f,g){"use strict";a=function(){function a(a){var b=this;this.waitFor=null;a!=null&&(this.waitFor=a.then(function(a){return b.waitFor=null}))}var b=a.prototype;b.chainPromiseOrValue=function(a){if(this.waitFor!=null)return this.waitFor.then(function(){return a("\ud83d\udd12")});else return a("\ud83d\udd12")};return a}();b=function(){function a(){this.lock=null}var b=a.prototype;b.chainPromiseOrValue=function(a){var b=this,d=this.lock;if(d==null){var e=a("\ud83d\udd12");if(c("isPromise")(e))d=e;else return e}else d=d.then(function(){return a("\ud83d\udd12")});var f=d.then(function(a){b.lock===f&&(b.lock=null);return a}).finally(function(a){b.lock===f&&(b.lock=null);return a});this.lock=f;return f};return a}();g.WaitForPromiseLock=a;g.ReStoreTransactionLock=b}),98);
__d("IntervalList",["FBLogger","LSDbKeyComparer","ReQLBounds"],(function(a,b,c,d,e,f,g){"use strict";function h(a){if(a==null)throw c("FBLogger")("messenger_web_product").mustfixThrow("must not be null");return a}function a(a,b){var c=new Map(),e=new Map(),f=new Map();function g(b,c){return c==null?!0:(c.gt!==void 0?a(b,c.gt)>0:c.gte!==void 0?a(b,c.gte)>=0:!0)&&(c.lt!==void 0?a(b,c.lt)<0:c.lte!==void 0?a(b,c.lte)<=0:!0)}function* i(a){var f=a,h={hd:d("LSDbKeyComparer").MAX_KEY,tl:0},i=0;while(f!==0&&e.size){i++;var j=f,k=f.tl;f.tl=i<b?h:0;try{var l=e.get(JSON.stringify(a));if(l!=null)for(l of l)yield l}finally{j.tl=k}f=j.tl}for(l of c.entries()){k=l[0];j=l[1];c.has(k)&&g(a,j)&&(yield k)}}function j(a){var b=f.get(a);if(b!=null){f["delete"](a);var d=h(e.get(b));d["delete"](a);d.size===0&&e["delete"](b)}else c["delete"](a)}function k(a,g){var h;if(a&&a.gte!=null&&a.lte!=null&&(h=JSON.stringify(d("ReQLBounds").nextKey(a.gte,b)))===JSON.stringify(a.lte)){var i=e.get(h);i==null&&(i=new Set(),e.set(h,i));i.add(g);f.set(g,h)}else c.set(g,a)}return{"delete":j,findIntersecting:i,set:k}}g["default"]=a}),98);
__d("I64MigrationHelper",["I64","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return c("nullthrows")(d("I64").cast(a))}g.cast=a}),98);
__d("LSTableDefaults",["I64MigrationHelper"],(function(a,b,c,d,e,f){e.exports={sync_groups:{syncStatus:(a=b("I64MigrationHelper")).cast([0,0]),sendSyncParams:!1,minTimeToSyncTimestampMs:a.cast([0,0]),canIgnoreTimestamp:!1,priority:a.cast([0,0]),lastSyncRequestTimestampMs:a.cast([0,0]),lastSyncCompletedTimestampMs:a.cast([0,0]),syncChannel:a.cast([0,1])},pending_tasks:{enqueueTimestampMs:a.cast([0,0]),firstExecutedTimestampMs:a.cast([0,0]),failureCount:a.cast([0,0]),minTimeToSyncTimestampMs:a.cast([0,0]),pluginType:a.cast([0,0]),priority:a.cast([0,0])},pending_fire_and_forget_tasks:{enqueueTimestampMs:a.cast([0,0]),priority:a.cast([0,0])},contacts:{isMessengerUser:!1,isMemorialized:!1,blockedByViewerStatus:a.cast([0,0]),rank:a.cast([0,0]),contactType:a.cast([0,0]),contactTypeExact:a.cast([0,0]),canViewerMessage:!0,gender:a.cast([0,0]),authorityLevel:a.cast([0,0]),optimisticBlockedByViewerStatus:a.cast([0,0]),optimisticBlockedByViewerStatusTimestampMs:a.cast([0,0]),contactReachabilityStatusType:a.cast([0,0]),restrictionType:a.cast([0,0]),waConnectStatus:a.cast([0,0]),capabilities2:a.cast([0,0]),isEmployee:!1},ig_contact_info:{e2eeEligibility:a.cast([0,0])},reactions:{timestampMs:a.cast([0,0]),authorityLevel:a.cast([0,0])},threads:{lastActivityTimestampMs:a.cast([0,0]),lastReadWatermarkTimestampMs:a.cast([0,0]),removeWatermarkTimestampMs:a.cast([0,0]),muteExpireTimeMs:a.cast([0,0]),isAdminSnippet:!1,ongoingCallState:a.cast([0,0]),snippetHasEmoji:!1,hasPersistentMenu:!1,disableComposerInput:!1,capabilities:a.cast([0,0]),isCustomThreadPicture:!1,isDisappearingMode:!1,unreadDisappearingMessageCount:a.cast([0,0]),authorityLevel:a.cast([0,0]),capabilities2:a.cast([0,0]),muteCallsExpireTimeMs:a.cast([0,0]),unsendLimitMs:a.cast([0,0]),threadInvitesEnabled:a.cast([0,0]),threadInvitesEnabledV2:a.cast([0,0]),capabilities3:a.cast([0,0]),muteMentionExpireTimeMs:a.cast([0,0]),isReadReceiptsDisabled:!1,readReceiptsDisabledV2:a.cast([0,0])},threads_ranges_v2__generated:{minThreadKey:a.cast([0,0]),minLastActivityTimestampMs:a.cast([0,0]),maxThreadKey:a.cast([0,0]),maxLastActivityTimestampMs:a.cast([0,0]),isLoadingBefore:!1,isLoadingAfter:!1,hasMoreBefore:!1,hasMoreAfter:!1},messages:{timestampMs:a.cast([0,0]),primarySortKey:a.cast([0,0]),secondarySortKey:a.cast([0,0]),isAdminMessage:!1,sendStatus:a.cast([0,0]),sendStatusV2:a.cast([0,0]),isUnsent:!1,replyStatus:a.cast([0,0]),replyAttachmentType:a.cast([0,0]),hasQuickReplies:!1,textHasLinks:!1,viewFlags:a.cast([0,0]),displayedContentTypes:a.cast([0,1]),quickReplyType:a.cast([0,0]),authorityLevel:a.cast([0,0]),unsentTimestampMs:a.cast([0,0]),isCollapsed:!1,messageRenderingType:a.cast([0,0])},messages_ranges_v2__generated:{isLoadingBefore:!1,isLoadingAfter:!1,hasMoreBefore:!1,hasMoreAfter:!1},participants:{readWatermarkTimestampMs:a.cast([0,0]),deliveredWatermarkTimestampMs:a.cast([0,0]),authorityLevel:a.cast([0,0]),readActionTimestampMs:a.cast([0,0]),groupParticipantJoinState:a.cast([0,0]),threadRoles:a.cast([0,0])},attachments:{timestampMs:a.cast([0,0]),attachmentType:a.cast([0,0]),hasMedia:!1,isSharable:!1,hasXma:!1,attachmentIndex:a.cast([0,0]),authorityLevel:a.cast([0,0])},attachments_ranges_v2__generated:{mediaGroup:a.cast([0,0]),isLoadingBefore:!1,isLoadingAfter:!1,hasMoreBefore:!1,hasMoreAfter:!1},attachment_items:{attachmentIndex:a.cast([0,0])},group_membership_approval_requests:{authorityLevel:a.cast([0,0])},admin_message_ctas:{timestampMs:a.cast([0,0]),showAdChoiceIcon:!1},thread_nullstate:{ctaType:a.cast([0,0]),privacyTextCtaType:a.cast([0,0])},messages_status:{timestampMs:a.cast([0,0])},polls:{pollType:a.cast([0,0])},poll_options_v2:{voteCount:a.cast([0,0]),sortKeyVotingTimestamp:a.cast([0,0]),sortKeyCreationTimestamp:a.cast([0,0])},filtered_threads_ranges_v3__generated:{minThreadKey:a.cast([0,0]),minLastActivityTimestampMs:a.cast([0,0]),maxThreadKey:a.cast([0,0]),maxLastActivityTimestampMs:a.cast([0,0]),isLoadingBefore:!1,isLoadingAfter:!1,hasMoreBefore:!1,hasMoreAfter:!1,folderName:"inbox",secondaryThreadRangeFilter:a.cast([0,0]),threadRangeFilterValue:""},community_folders:{capabilities:a.cast([0,0]),notificationMutedUntil:a.cast([0,0]),inviteStatus:a.cast([0,0]),capabilities2:a.cast([0,0]),capabilities3:a.cast([0,0])},community_members:{source:a.cast([0,0]),adminActions:a.cast([0,0]),contactCapabilities:a.cast([0,0]),channelBadges:a.cast([0,0]),threadRoles:a.cast([0,0]),requestId:""},inbox_threads_ranges:{minThreadKey:a.cast([0,0]),minLastActivityTimestampMs:a.cast([0,0]),isLoadingBefore:!1,hasMoreBefore:!1},community_direct_invites_presets:{fallbackUrl:"",pictureUrlExpirationTimestampMs1:a.cast([0,0]),pictureUrlExpirationTimestampMs2:a.cast([0,0]),presetTypeV2:"ALL_MEMBERS"},sync_group_threads_ranges:{minThreadKey:a.cast([0,0]),minLastActivityTimestampMs:a.cast([0,0]),isLoadingBefore:!1,hasMoreBefore:!1},community_chat_polls:{pollType:a.cast([0,0])},community_chat_poll_options:{voteCount:a.cast([0,0]),sortKeyVotingTimestamp:a.cast([0,0]),sortKeyCreationTimestamp:a.cast([0,0])},reactions_v2:{viewerReactionTimestampMs:a.cast([0,0]),lastUpdatedTimestampMs:a.cast([0,0])},group_invitations_pending:{communityJoinRequestStatus:a.cast([0,0]),communityParticipationControlRequestStatus:a.cast([0,0]),communityParticipationControlSetting:a.cast([0,0])},thread_label_mappings:{sortKey:a.cast([0,0])},inbox_view_state:{value:""},inbox_view_state_v2:{value:""},discoverable_chat_participants:{source:a.cast([0,0])},roll_calls:{viewerHasContributed:!1,viewerCanEditPrompt:!1,isBlurred:!1,canViewWithoutContributing:!1},roll_call_contributions_v2:{contributorId:a.cast([0,0]),contributionSource:a.cast([0,0])},shared_albums:{lastActivityTimestampMs:a.cast([0,0]),contributionCount:a.cast([0,0])},shared_album_contributions:{creationTimestampMs:a.cast([0,0]),creatorId:a.cast([0,0])},universal_search_recent_searches:{lastAccessedTimestampMs:a.cast([0,0])},cm_search_nullstate_metadata:{score:0},contact_upload_settings:{authorityLevel:a.cast([0,0])},presence_settings:{isActiveStatusViewable:!1,isActiveStatusViewableOnFb:!1,isActiveStatusViewableOnMessenger:!1,hasConvertedToViewSideSettings:!1},video_chat_links_joining:{canAnonymousUsersJoin:a.cast([0,0])},notification_settings:{includeInSwitchAccountBadges:!1,mutePageAccountMessageReminder:!1},avatar_settings:{enableAvatarHotlike:!1},messaging_privacy_settings:{readReceiptsDisabled:a.cast([0,0])},rtc_call_events:{isProcessed:!1},transaction_history:{timestampMs:a.cast([0,0])},thread_themes:{isDeprecated:!1,iconUrl:"",iconUrlFallback:"",backgroundUrl:""},ranking_scores:{score:a.cast([0,0]),scoreIndex:a.cast([0,0])},story_buckets:{pageNum:a.cast([0,0]),readState:a.cast([0,0])},stories:{authorityLevel:a.cast([0,0])},story_viewers:{interactionType:a.cast([0,1]),authorityLevel:a.cast([0,0])},story_reactions:{authorityLevel:a.cast([0,0])},story_ad_unit:{shouldShowAdChoice:!1},story_overlays:{authorityLevel:a.cast([0,0])},rooms:{notificationMutedUntilMs:a.cast([0,0])},media_staging:{progress:a.cast([0,0])},client_messages:{textSize:a.cast([0,0]),sendStatus:a.cast([0,0]),isHidden:!1,isTombstoned:!1,isReplyOnly:!1,messageContentType:a.cast([0,0]),messageContentSubtype:a.cast([0,0]),messageSource:a.cast([0,0]),messageCreationType:a.cast([0,0]),messageEphemeralityType:a.cast([0,0]),replyStatus:a.cast([0,0]),replyMessageTextSize:a.cast([0,0]),replyVicinityStatus:a.cast([0,0]),isForwarded:!1,isReadonly:!1,disabledActionsReason:a.cast([0,0]),shouldPersist:!1,shouldHideInSnippet:!1},client_participants:{isPending:!1,capabilities1:a.cast([0,0]),capabilities2:a.cast([0,0]),readActionTsMs:a.cast([0,0])},client_threads:{isAdminSnippet:!1,isHotlikeSnippet:!1,groupMemberAddMode:a.cast([0,0]),capabilities1:a.cast([0,0]),capabilities2:a.cast([0,0]),isHidden:!1,isTombstoned:!1,isPending:!1,isShadowThread:!1,pinnedMessagesCount:a.cast([0,0])},data_trace_meta:{initTimestampMs:a.cast([0,0]),foregroundTimestampMs:a.cast([0,0]),traceType:a.cast([0,0]),shouldFlush:!1},data_trace_addon:{timestampMs:a.cast([0,0])},secure_encrypted_backups_client_state:{authorityLevel:a.cast([0,0]),encryptionVersion:a.cast([0,0]),revisionVersion:a.cast([0,0])},secure_encrypted_backups_epochs:{authorityLevel:a.cast([0,0])},encrypted_backups:{authorityLevel:a.cast([0,0]),hasOtcEligibleDevices:!1},secure_encrypted_backups_generated_recovery_code:{virtualDeviceType:a.cast([0,1])},encrypted_backups_virtual_devices:{virtualDeviceType:a.cast([0,1]),removalStatus:a.cast([0,1])},encrypted_backups_metadata:{authorityLevel:a.cast([0,0])},cutover_threads:{isMigrated:!1,showOpenMessageHistory:!1},persistent_menu_ctas:{ctaType:"fallback"}}}),null);
__d("MWTabNotifierWhenPDBEnabled",["cr:3107"],(function(a,b,c,d,e,f,g){"use strict";g["default"]=b("cr:3107")}),98);
__d("ReStoreUtils",["LSTableDefaults"],(function(a,b,c,d,e,f,g){"use strict";async function a(a){var b=[],c=await a.next();while(!c.done)b.push(c.value),c=await a.next();return b}function b(a,b){var d=c("LSTableDefaults")[b];return!d?a:Object.keys(d).reduce(function(a,b){Object.prototype.hasOwnProperty.call(a,b)||(a[b]=d[b]);return a},babelHelpers.extends({},a))}g.collectIterator=a;g.appendDefaultValues=b}),98);
__d("ReStoreDefaultValueMigration",["LSPlatformLsInitLog","LSTableDefaults","ReStoreDefaultValuesMetadata","ReStoreUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c={};b=(yield d("ReStoreUtils").collectIterator(b.table(d("ReStoreDefaultValuesMetadata").defaultValuesTableName).entries(a)));for(a of b){b=a[0];var e=a[1];if(b!=null){var f;b=d("ReStoreDefaultValuesMetadata").tryParseDefaultValuesData(e);if(b==null)continue;e=b.columns;b=b.tableName;c[b]=(f=c[b])!=null?f:new Set();for(f of e)c[b].add(f)}}return c});return i.apply(this,arguments)}function j(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,d){a=(yield h(a,b));b={};for(d in d.tableNames){var e=c("LSTableDefaults")[d];if(e!=null)for(var f in e){var g;g=(g=a[d])==null?void 0:g.has(f);if(!g){b[d]=(g=b[d])!=null?g:{};b[d][f]=e[f]}}}return b});return k.apply(this,arguments)}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){for(b in b){var e=Object.keys(c("LSTableDefaults")[b]||{});e={columns:e,tableName:b};yield a.table(d("ReStoreDefaultValuesMetadata").defaultValuesTableName).put(d("ReStoreDefaultValuesMetadata").defaultValuesColumnToValue(e))}});return m.apply(this,arguments)}function a(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=new WeakMap();d("LSPlatformLsInitLog").addPoint("default_values_update_start");var e=function(a,b){d("LSPlatformLsInitLog").addPoint("default_values_update_end_failure",{string:{default_values_update_failure_point:b,default_values_update_failure_reason:String(a)}})};try{b=(yield j(c,a,b));try{for(var f in b){var g=a.table(f).entries(c),h=(yield g.next());while(!h.done){var i=babelHelpers["extends"]({},h.value[1]);i=d("ReStoreUtils").appendDefaultValues(i,f);yield a.table(f).put(i);h=(yield g.next())}}yield l(a,b);d("LSPlatformLsInitLog").addPoint("default_values_update_end")}catch(a){e(a,"setDefaultValues")}}catch(a){e(a,"findDefaultValuesToUpdate")}});return n.apply(this,arguments)}g.runMigrationForTableDefaultValuesIfNeeded=a}),98);
__d("ReStoreHooks",["PromiseOrValue"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return{afterEntriesNext:a.reduce(function(a,b){var c=b.onAfterEntriesNext;return c?function(b){return c({tableName:b.tableName,value:a(b)})}:a},function(a){a=a.value;return a}),afterGet:a.reduce(function(a,b){var c=b.onAfterGet;return c?function(b){return c({tableName:b.tableName,value:a(b)})}:a},function(a){a=a.value;return a}),beforeAdd:a.reduce(function(a,b){var c=b.onBeforeAdd;return c?function(b){return d("PromiseOrValue").map(a(b),function(a){return c(babelHelpers.extends({},b,{value:a}))})}:a},function(a){a=a.value;return a}),beforeDeleteThenInsert:a.reduce(function(a,b){var c=b.onBeforeDeleteThenInsert;return c?function(b){return d("PromiseOrValue").map(a(b),function(a){return c(babelHelpers.extends({},b,{value:a}))})}:a},function(a){a=a.value;return a}),beforeNotify:a.reduce(function(a,b){var c=b.onBeforeNotify;return c?function(b){var d=a(b),e=d.newValue;d=d.prevValue;return c({newValue:e,prevValue:d,tableName:b.tableName})}:a},function(a){var b=a.newValue;a=a.prevValue;return{newValue:b,prevValue:a}}),beforePut:a.reduce(function(a,b){var c=b.onBeforePut;return c?function(b){return d("PromiseOrValue").map(a(b),function(a){return c(babelHelpers.extends({},b,{value:a}))})}:a},function(a){a=a.value;return a}),beforeUpsert:a.reduce(function(a,b){var c=b.onBeforeUpsert;return c?function(b){return d("PromiseOrValue").map(a(b),function(a){return c(babelHelpers.extends({},b,{value:a}))})}:a},function(a){a=a.value;return a})}}g.createHookManager=a}),98);
__d("ReStoreIndicesMigration",["LSPlatformLsInitLog","ReStoreIndexMetadata","ReStoreUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c={};b=(yield d("ReStoreUtils").collectIterator(b.table(d("ReStoreIndexMetadata").indicesTableName).entries(a)));for(a of b){b=a[0];var e=a[1];if(b!=null){var f;e=d("ReStoreIndexMetadata").tryParseIndexData(e);if(e==null)continue;var g=e.indexName,h=e.tableName;c[h]=(f=c[h])!=null?f:{};c[h][g]={index:e.data,key:b}}}return c});return i.apply(this,arguments)}function j(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=(yield h(a,b));b={};for(var e in c.tableNames){var f=c.tableNames[e];for(var g in f.indexes){var i,j=f.indexes[g];i=(i=a[e])==null?void 0:i[g];if(d("ReStoreIndexMetadata").indicesDiffer(i==null?void 0:i.index,j)){b[e]=(i=b[e])!=null?i:{};b[e][g]=j}}}i={};for(j in a){g=a[j];for(f in g){var k;e=g[f];k=(k=c.tableNames[j])==null?void 0:(k=k.indexes)==null?void 0:k[f];if(k==null){i[j]=(k=i[j])!=null?k:{};i[j][f]=e}}}return{toRemove:i,toUpdate:b}});return k.apply(this,arguments)}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){for(var c in b){var e=b[c];for(var f in e){var g=e[f];g={data:g,indexName:f,tableName:c};yield a.table(d("ReStoreIndexMetadata").indicesTableName).put(d("ReStoreIndexMetadata").indexDataToValue(g))}}});return m.apply(this,arguments)}function n(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){for(var c in b){var e=b[c];for(var f in e){var g=e[f].key;yield a.table(d("ReStoreIndexMetadata").indicesTableName)["delete"](g)}}});return o.apply(this,arguments)}function a(a,c,e){var f=new WeakMap();d("LSPlatformLsInitLog").addPoint("index_migration_start");var g=function(a,b){d("LSPlatformLsInitLog").addPoint("index_migration_end_failure",{string:{index_migration_failure_point:b,index_migration_failure_reason:String(a)}})};return j(f,a,c).then(function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var f=b.toRemove;b=b.toUpdate;var g=Array.from(new Set([].concat(Object.keys(b),Object.keys(f))));d("LSPlatformLsInitLog").addAnnotations({"int":{index_migration_rebuild_tables_count:g.length},string_array:{index_migration_rebuilt_tables:g}});for(g of g)if(c.tableNames[g]!=null){var h;h=Array.from(new Set([].concat(Object.keys((h=b[g])!=null?h:{}),Object.keys((h=f[g])!=null?h:{}))));yield e(g,h)}yield l(a,b);yield n(a,f);d("LSPlatformLsInitLog").addPoint("index_migration_end")});return function(a){return f.apply(this,arguments)}}(),function(a){return g(a,"findIndicesToUpdateOrRemove")})["catch"](function(a){return g(a,"rebuildIndices")})}g.runMigrationForIndicesIfNeeded=a}),98);
__d("killswitchMessengerWebPersistedDB",["killswitch"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("killswitch")("MESSENGER_WEB_PERSISTED_DB")}g.check=a}),98);
__d("createReStoreSubscriptionManager",["ExecutionEnvironment","FBLogger","IntervalList","LSDatabaseProviderType","LSDbKeyComparer","LSStorage","MWTabNotifierWhenPDBEnabled","Promise","asyncToGeneratorRuntime","gkx","killswitchMessengerWebPersistedDB","nullthrows","promiseDone","react"],(function(a,b,c,d,e,f,g){"use strict";e=d("react").startTransition;var h=c("gkx")("9157")?e:function(a){return a()};function a(a,e,f){var g=d("LSDatabaseProviderType").hasPersistentType(f),i=new Map(),j=new Map();function k(a,b){return d("LSDbKeyComparer").compareValue(a,b)===0}function l(a,b,c,d){a=(a=v.get(a))!=null?a:[];var e=[];for(var f=0;f<b.length;f++){var g=b[f];for(var h=0;h<32&&g>0;h++){if(g&1){var i=a[(f<<5)+h];if(!k(c[i],d[i])){e[f]=((i=e[f])!=null?i:0)|1<<h%32}}g=g>>>1}}return e}function m(a,b){for(var c=0;c<Math.max(a.length,b.length);c++)if((a[c]&b[c])!==0)return!0;return!1}function n(a,c,d,e,f){var g=Array.from(c(e));if(f.operation==="put"&&f.prevValue!=null){c=function(){var c=f.prevValue,h=[];for(var i of g){i[0];var j=i[1];j!=null&&j.forEach(function(a,b){h[b]=((b=h[b])!=null?b:0)|a})}var k=l(a,h,c,f.value);return{v:b("Promise").all(g.map(function(a){var b=a[0];a=a[1];if(a==null||m(k,a))return b(e,f,d)}))}}();if(typeof c==="object")return c.v}return b("Promise").all(g.map(function(a){var b=a[0];a[1];return b(e,f,d)}))}function o(b){return c("nullthrows")((i.has(b)?i:i.set(b,[c("IntervalList")(d("LSDbKeyComparer").compareKey,a.tableNames[b].primaryKeyIds.length),new Map()])).get(b))}function p(b,e){var f=o(b);f[0];f=f[1];return c("nullthrows")((f.has(e)?f:f.set(e,c("IntervalList")(d("LSDbKeyComparer").compareKey,a.tableNames[b].indexes[e].length))).get(e))}function q(e,f,g,h,i,j){var k=function(a,b){return n(f,e.findIntersecting,j,a,b)},l=g==null?void 0:d("LSStorage").searchKey(a,f,g,i),m=h==null?void 0:d("LSStorage").searchKey(a,f,h,i);if(m==null&&l!=null)return k(l,{operation:"delete",prevValue:g});if(l==null&&m!=null)return k(m,{operation:"add",value:c("nullthrows")(h)});return l!=null&&m!=null?d("LSDbKeyComparer").compareKey(l,m)===0?k(l,{operation:"put",prevValue:g,value:c("nullthrows")(h)}):k(l,{operation:"delete",prevValue:g}).then(function(){return k(m,{operation:"add",value:c("nullthrows")(h)})}):b("Promise").resolve()}function r(a,c,d,e){var f=o(a),g=f[0],h=f[1];return q(g,a,c,d,null,e).then(function(){return b("Promise").all(Array.from(h.entries()).map(function(b){var f=b[0];b=b[1];return q(b,a,c,d,f,e)}).filter(function(a){return a!=null}))})}function s(){h(function(){return j.forEach(function(a){return a()})})}function t(a,b){function f(){var d=new Map();try{for(var f of a){var g=f[0],h=f[1];g=JSON.parse(g);var i=g[0];g[1];if(e(b,i)){g=d.get(i)||[];d.set(i,[].concat(g,[h]))}}}catch(a){c("FBLogger")("messenger_web_product").catching(a).mustfix("Couldnot format changes to broadcast")}return Array.from(d)}if(c("ExecutionEnvironment").isInBrowser&&(!d("killswitchMessengerWebPersistedDB").check()&&c("MWTabNotifierWhenPDBEnabled")!=null&&g)){f=f();if(f.length===0)return;c("MWTabNotifierWhenPDBEnabled").postMessage(b,f)}}c("ExecutionEnvironment").isInBrowser&&(!d("killswitchMessengerWebPersistedDB").check()&&c("MWTabNotifierWhenPDBEnabled")!=null&&g&&c("MWTabNotifierWhenPDBEnabled").onEventReceive("notifyTableV2",function(a){c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=new WeakMap();for(var c of a){var d=c[0],e=c[1];for(e of e){var f=e[0],g=e[1];yield r(d,f,g,b)}}s()})())}));var u=new Map(),v=new Map();function w(a,b){if(b==null)return null;var c=u.get(a);c==null&&(c=new Map(),u.set(a,c));var d=[];for(b of b){var e=c.get(b);if(e==null){e=c.size;c.set(b,e);var f=v.get(a);f==null&&(f=[],v.set(a,f));f.push(b)}f=e>>5;e=e&31;d[f]=((f=d[f])!=null?f:0)|1<<e}return d}return{dispose:function(){i.clear(),j.clear()},notifyCommit:s,notifyTableAndIndexSubscribers:r,notifyTableV2:t,subscribeIndex:function(a,c,d,e,f){var g=p(a,c),h=!1;c=function(a,c,e){return h?b("Promise").resolve():d(a,c,e)};var i=[c,w(a,f)];g.set(e,i);return function(){h=!0,g["delete"](i)}},subscribeTable:function(a,c,d,e){var f=o(a),g=f[0],h=!1;f=function(a,d,e){return h?b("Promise").resolve():c(a,d,e)};var i=[f,w(a,e)];g.set(d,i);return function(){h=!0,g["delete"](i)}},subscribeToCommit:function(a){j.set(a,a);return function(){j["delete"](a)}}}}g["default"]=a}),98);
__d("ReStore",["BPlusTreeBase","ExecutionEnvironment","FBLogger","I64","LSDatabaseProviderType","LSDbKeyComparer","LSPlatformLsInitLog","LSStorage","LSTableDefaults","MWTabNotifierWhenPDBEnabled","MetaConfig","PromiseOrValue","ReQLBounds","ReStoreDefaultValueMigration","ReStoreDefaultValuesMetadata","ReStoreHooks","ReStoreIndicesMigration","ReStorePersistence","ReStoreTransactionLock","ReStoreUtils","clearTimeout","cr:1088","cr:1242","createReStoreSubscriptionManager","err","hashString","isPromise","killswitchMessengerWebPersistedDB","promiseDone","setImmediate","setTimeout","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";e=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.call(this,"Transaction has finished")||this}return b}(babelHelpers.wrapNativeSuper(Error));function h(a){a=d("I64").cast(a);if(a===void 0)throw c("unrecoverableViolation")("Expected int64","messenger_web_product");return d("I64").to_float(a)}function i(a,b){function d(b){if(b.done)return b.value;if(!c("isPromise")(b.value))throw c("unrecoverableViolation")("expected promise","messenger_web_product");return b.value.then(function(b){return d(a.next(b))})}return d(a.next(b))}function j(a,b){return{next:function(c){return b.chainPromiseOrValue(function(b){return a.next(b,c)})}}}function k(a,b,e){return c("BPlusTreeBase")(d("LSDbKeyComparer").compareKey,16,b.getBPlusTreeStore(a,e==null?"root":"index("+e+")"))}function l(a,b,c){return(a.has(b)?a:a.set(b,c())).get(b)}function a(a,e,f){f===void 0&&(f=[]);var g=d("ReStorePersistence").createDbStore(a),n=c("createReStoreSubscriptionManager")(e,a.shouldSync,a.types),o=d("ReStoreHooks").createHookManager(f),p=b("LSStorage").searchKey.bind(null,e),q={background:{first:null,last:null},sync_script:{first:null,last:null},ui:{first:null,last:null}},r=c("hashString")(JSON.stringify(e)),s=c("hashString")(JSON.stringify(c("LSTableDefaults")));d("LSPlatformLsInitLog").addAnnotations({int:{defaultValuesVersion:s,schemaVersion:r}});d("LSPlatformLsInitLog").addPoint("migration_start");var t=new(d("ReStoreTransactionLock").WaitForPromiseLock)(g.runExclusively(async function(){d("LSPlatformLsInitLog").addPoint("migration_execute_start");var a=new Map(),b=g.createTransaction("readwrite"),f=K(b,a),h="schema_version",i="default_value_version";if(c("MetaConfig")._("59")){var j,k;j=(j=await Promise.resolve(b.table(d("ReStoreDefaultValuesMetadata").schemaVersionTableName).readData(new WeakMap(),h).next().value))==null?void 0:j.schemaVersion;k=(k=await Promise.resolve(b.table(d("ReStoreDefaultValuesMetadata").schemaVersionTableName).readData(new WeakMap(),i).next().value))==null?void 0:k.defaultValuesVersion;j!=null&&d("LSPlatformLsInitLog").addAnnotations({int:{storeDefaultValuesVersion:k,storeSchemaVersion:j}});if(j===r&&k===s){b.close();d("LSPlatformLsInitLog").addPoint("migration_skipped");return}}try{await d("ReStoreDefaultValueMigration").runMigrationForTableDefaultValuesIfNeeded(f,e);await d("ReStoreIndicesMigration").runMigrationForIndicesIfNeeded(f,e,function(c,e){return new(d("ReStoreTransactionLock").ReStoreTransactionLock)().chainPromiseOrValue(function(d){return J(a,b,new WeakMap(),c,e,d)})});d("LSPlatformLsInitLog").addPoint("migration_execute_end");j=!0;c("MetaConfig")._("59")&&(a.size===0&&(j=!1),b.table(d("ReStoreDefaultValuesMetadata").schemaVersionTableName).writeData(new WeakMap(),h,{schemaVersion:r}),b.table(d("ReStoreDefaultValuesMetadata").schemaVersionTableName).writeData(new WeakMap(),i,{defaultValuesVersion:s}));await b.flush({upgrade:j})}catch(a){b.close();throw a}d("LSPlatformLsInitLog").addPoint("migration_end")}).catch(function(a){d("LSPlatformLsInitLog").addAnnotations({string:{migration_error:a.message}});d("LSPlatformLsInitLog").fail("migration_error");throw a})),u=new Map();async function v(a,b){var c=new WeakMap();await g.runExclusively(async function(){var d=new Map(),e=g.createTransaction("readwrite");d=K(e,d);for(var f of b){var h=f[0],i=f[1];if(i==null){var j=p(a,h);await d.table(a).delete(j)}else await d.table(a).put(i);j=o.beforeNotify({newValue:i,prevValue:h,tableName:a});i=j.newValue;h=j.prevValue;await n.notifyTableAndIndexSubscribers(a,h,i,c)}try{await e.flush({upgrade:!0})}catch(a){e.close();throw a}})}function w(a,b,c,d,e){b=JSON.stringify([b,c]);c=a.get(b);a.set(b,[c==null?d:c[0],e])}async function x(a,b,c,d,e,f){f=a.table(c);a=k(b,f,d);d=await i(a.getWithDefault(e,void 0));if(d===void 0)return void 0;a=await i(f.readDataExn(b,d));return o.afterGet({tableName:c,value:a})}async function y(a,b,c,d,e,f){a=await x(a,b,c,d,e,f);return a===void 0?void 0:p(c,a)}function z(a,b,c,f,g,h){function j(){var m=a.table(c),n=k(b,m,f),l=n.entries(babelHelpers.extends({},d("ReQLBounds").extendBounds(h,(f===void 0?e.tableNames[c].primaryKeyIds:e.tableNames[c].indexes[f]).length),{dir:g}));return n={next:function(a,e){return d("PromiseOrValue").map(i(l.next(e)),function(a){return a.done?{done:!0}:d("PromiseOrValue").map(i(m.readDataExn(b,a.value[1])),function(b){return{done:!1,value:[a.value[0],o.afterEntriesNext({tableName:c,value:b})]}})})}},n[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]=j,n}return j()}async function A(a,b,c,f,g,h,i){function j(a,b){var c=[],e=a;while(e!==0)c.push(e.hd),e=e.tl;return c.length>=b?a:c.reduceRight(function(a,b){return{hd:b,tl:a}},{hd:d("LSDbKeyComparer").MAX_KEY,tl:0})}if(h!=null&&d("LSDbKeyComparer").compareKey(g,h)===0)return;f=e.tableNames[f];var k=f.cascadeUpdates,l=f.primaryKeyIds;f=async function(d){var f=d.indexName;d=d.tableName;var k=e.tableNames[d],m=k.indexes;k=k.primaryKeyIds;var n=f==null?k:m[f];k={gte:g,lte:j(g,n.length)};m=z(b,c,d,f,"asc",k);f=[];k=await m.next(i);while(!k.done)f.push(k.value),k=await m.next(i);for(m of f){m[0];k=m[1];f=p(d,k);if(h===void 0)await E(a,b,c,d,f,i),await A(a,b,c,d,f,void 0,i);else{k=l.reduce(function(a,b,c){b=a[0];a=a[1];if(!a)return[b,a];b[n[c]]=a.hd;return[b,a.tl]},[babelHelpers.extends({},k),h])[0];await D(a,b,c,d,f,k,i);await A(a,b,c,d,f,p(d,k),i)}}};for(k of k)await f(k)}async function B(a,b,f,g){g=e.tableNames[f].autoIncrement;if(!g)throw c("unrecoverableViolation")("only supported for auto-incrementing tables","messenger_web_product");g=await a.table(f).readSeed(b);if(g===void 0)throw c("unrecoverableViolation")("unexpected undefined autoIncrementSeed","messenger_web_product");return d("I64").of_float(g)}async function C(a,b,c,f,g,j){var l=b.table(f),m=k(c,l),n=e.tableNames[f];if(n.autoIncrement){var o=g[n.primaryKeyIds[0]];o=d("I64").of_float(await l.incrementSeed(c,o===void 0?o:h(o)));g[n.primaryKeyIds[0]]=o}o=p(f,g);var q={},r=await i(m.getWithDefault(o,void 0)),s,t=g;r!==void 0?(s=await i(l.readDataExn(c,r)),q=F(Object.keys(n.indexes),f,s),l.writeData(c,r,t)):(t=d("ReStoreUtils").appendDefaultValues(g,n.name),r=await l.writeNewData(c,t),await i(m.set(o,r)));g=F(Object.keys(n.indexes),f,t);for(m of Object.keys(g))q[m]!==void 0&&d("LSDbKeyComparer").compareKey(q[m],g[m])===0&&(delete g[m],delete q[m]);await G(a,b,c,f,g,j);await H(b,c,f,r,g);for(n of Object.keys(q)){m=k(c,l,n);await i(m.delete(q[n]))}w(a,f,o,s,t)}async function D(a,b,c,e,f,g,h){var i=p(e,g);d("LSStorage").areKeysEqual(f,i)||await E(a,b,c,e,f,h);await C(a,b,c,e,g,h)}async function E(a,b,c,d,f,g){g=b.table(d);b=k(c,g);var h=e.tableNames[d],j=await i(b.getWithDefault(f,void 0)),l;if(j!==void 0){l=await i(g.readDataExn(c,j));if(Object.keys(h.indexes).length)for(h of Object.keys(h.indexes)){var m=p(d,l,h);if(m!=null){var n=k(c,g,h);await i(n.delete(m))}}await i(b.delete(f));g.remove(c,j);w(a,d,f,l,void 0)}}function F(a,b,c){return a.reduce(function(a,d){var e=p(b,c,d);a[d]=e;return a},{})}async function G(a,b,c,d,e,f){var g=b.table(d),h=new Set();for(var j of Object.keys(e)){var l=k(c,g,j),m=e[j];l=await i(l.getWithDefault(m));if(l!=null&&!h.has(l)){m=p(d,await i(g.readDataExn(c,l)));await E(a,b,c,d,m,f);await A(a,b,c,d,m,void 0,f);h.add(l)}}}async function H(a,b,c,d,e){a=a.table(c);for(c of Object.keys(e)){var f=k(b,a,c),g=e[c];await i(f.set(g,d))}}async function I(a,b,c,f,g,j){var l=b.table(f),m=k(c,l),n=e.tableNames[f];if(n.autoIncrement){var o=g[n.primaryKeyIds[0]];o=d("I64").of_float(await l.incrementSeed(c,o===void 0?o:h(o)));g[n.primaryKeyIds[0]]=o}o=d("ReStoreUtils").appendDefaultValues(g,n.name);g=p(f,o);if(g==null)throw new Error("Evaluating the object store's key path did not yield a value");if(!await i(m.has(g))){n=F(Object.keys(n.indexes),f,o);await G(a,b,c,f,n,j);j=await l.writeNewData(c,o);await i(m.set(g,j));await H(b,c,f,j,n);w(a,f,g,void 0,o)}}async function J(a,b,c,d,f,g){var h=b.table(d),j=f.map(function(a){return k(c,h,a)});for(j of j)await i(j.clear());j=f.filter(function(a){var b;return((b=e.tableNames[d])==null?void 0:b.indexes[a])!=null});if(j.length===0)return;f=k(c,h);var l=z(b,c,d,void 0,"asc",void 0),m=[],n=await l.next(g);while(!n.done)m.push(n.value),n=await l.next(g);for(l of m){n=l[0];m=l[1];m=F(j,d,m);await G(a,b,c,d,m,g);n=await i(f.get(n));await H(b,c,d,n,m)}}function K(a,c,f){var g=new(d("ReStoreTransactionLock").ReStoreTransactionLock)(),h=new WeakMap(),i=f==null?void 0:f.instanceKey,k={table:function(f){return{add:async function(d){var e=await o.beforeAdd({tableName:f,transaction:k,value:d});return g.chainPromiseOrValue(async function(d){b("cr:1242")==null?void 0:b("cr:1242").recordLogicalWrite(i),await I(c,a,h,f,e,d)})},delete:function(d){return g.chainPromiseOrValue(async function(e){b("cr:1242")==null?void 0:b("cr:1242").recordLogicalWrite(i),await E(c,a,h,f,d,e),await A(c,a,h,f,d,void 0,e)})},deleteThenInsert:async function(e){var j=await o.beforeDeleteThenInsert({tableName:f,transaction:k,value:d("ReStoreUtils").appendDefaultValues(e,f)});return g.chainPromiseOrValue(async function(d){b("cr:1242")==null?void 0:b("cr:1242").recordLogicalWrite(i),await C(c,a,h,f,j,d),await A(c,a,h,f,p(f,j),void 0,d)})},entries:function(b,c,d){c===void 0&&(c="asc");return j(z(a,h,f,void 0,c,d),g)},get:function(b){return g.chainPromiseOrValue(function(c){return x(a,h,f,void 0,b,c)})},index:function(b){return{entries:function(c,d,e){d===void 0&&(d="asc");return j(z(a,h,f,b,d,e),g)},get:function(c){return g.chainPromiseOrValue(function(d){return x(a,h,f,b,c,d)})},getKey:function(c){return g.chainPromiseOrValue(function(d){return y(a,h,f,b,c,d)})},keyLength:e.tableNames[f].indexes[b].length}},keyLength:e.tableNames[f].primaryKeyIds.length,peekNextAutoIncrementId:function(){return g.chainPromiseOrValue(function(b){return B(a,h,f,b)})},put:async function(d){var e=await o.beforePut({tableName:f,transaction:k,value:d});return g.chainPromiseOrValue(async function(d){b("cr:1242")==null?void 0:b("cr:1242").recordLogicalWrite(i),await C(c,a,h,f,e,d)})},upsert:async function(d,e){var j=await o.beforeUpsert({tableName:f,transaction:k,value:e});return g.chainPromiseOrValue(async function(g){b("cr:1242")==null?void 0:b("cr:1242").recordLogicalWrite(i),await D(c,a,h,f,d,j,g),await A(c,a,h,f,d,p(f,e),g)})}}}};return k}function L(a,b){return new Promise(function(c,d){q[b].last==null?q[b].first=q[b].last={value:function(){return a().then(c,d)}}:q[b].last=q[b].last.next={value:function(){return a().then(c,d)}}})}function M(){return g.runExclusively(async function(){var a=q.ui.first!=null?q.ui:q.sync_script.first!=null?q.sync_script:q.background;if(a.first==null){c("FBLogger")("messenger_web_product").mustfix("Expected work is missing");return}var b=a.first;a.first===a.last&&(a.last=null);a.first=a.first.next;await b.value()})}async function N(d,e,f){f===void 0&&(f="background");var h,i,j,k,l,p,q=b("cr:1242")==null?void 0:b("cr:1242").startTracking(a.types,f);(c("MetaConfig")._("26")||c("MetaConfig")._("27")||b("cr:1088"))&&(h=c("err")("Transaction timeout"));b("cr:1088")&&(i=Date.now());async function e(){b("cr:1242")==null?void 0:b("cr:1242").mark(q,"execute_start");b("cr:1088")&&(j=Date.now());var a={ref:void 0},e=new Map(),f=g.createTransaction("readwrite"),r;try{var s=K(f,e,{instanceKey:q});r=await Promise.race([d(s),m(h,a)]);a.ref!=null&&c("clearTimeout")(a.ref);b("cr:1088")&&(k=Date.now());b("cr:1242")==null?void 0:b("cr:1242").mark(q,"execute_end");b("cr:1242")==null?void 0:b("cr:1242").mark(q,"flush_start");await f.flush({instanceKey:q});b("cr:1242")==null?void 0:b("cr:1242").mark(q,"flush_end")}catch(d){a.ref!=null&&c("clearTimeout")(a.ref);f.close();b("cr:1242")==null?void 0:b("cr:1242").fail(q);throw d}b("cr:1088")&&(p=Date.now());b("cr:1242")==null?void 0:b("cr:1242").mark(q,"broadcast_start");s=new WeakMap();for(a of e){f=a[0];var t=a[1],u=t[0];t=t[1];f=JSON.parse(f);var v=f[0];f[1];f=o.beforeNotify({newValue:t,prevValue:u,tableName:v});t=f.newValue;u=f.prevValue;await n.notifyTableAndIndexSubscribers(v,u,t,s)}await g.queueCommitWork(function(){n.notifyTableV2(e,"notifyTableV2");n.notifyTableV2(e,"notifyInMemoryTable");return Promise.resolve()});n.notifyCommit();if(b("cr:1088")){l=Date.now();f={broadcast:l,complete:k,flush:p,queue:i,start:j};b("cr:1088").recordRestoreTransaction(h,f,{changedKeys:e})}b("cr:1242")==null?void 0:b("cr:1242").mark(q,"broadcast_end");b("cr:1242")==null?void 0:b("cr:1242").mark(q,"post_commit_start");c("setImmediate")(function(){b("cr:1242")==null?void 0:b("cr:1242").mark(q,"post_commit_end"),b("cr:1242")==null?void 0:b("cr:1242").end(q)});return r}var r=f==="background"&&c("MetaConfig")._("39")?new Promise(function(a){return c("setTimeout")(a,0)}):Promise.resolve();await r;r=L(e,f);c("promiseDone")(M());return r}f=d("LSDatabaseProviderType").hasPersistentType(a.types);c("ExecutionEnvironment").isInBrowser&&(!d("killswitchMessengerWebPersistedDB").check()&&c("MWTabNotifierWhenPDBEnabled")!=null&&f&&c("MWTabNotifierWhenPDBEnabled").onEventReceive("notifyInMemoryTable",function(b){c("promiseDone")(async function(){for(var c of b){var d=c[0],e=c[1];a.shouldApplySync("notifyInMemoryTable",d)&&await v(d,e)}n.notifyCommit()}())}));return{clearCacheIfSupported:function(){var a=g;a instanceof Object&&a.clearCache!==void 0&&a.clearCache instanceof Function&&a.clearCache()},closeDb:function(){var a=g;a instanceof Object&&a.close!==void 0&&a.close()},getTableData:function(){return e},persistenceTypes:a.types,runInTransaction:N,subscribeToCommit:function(a){return n.subscribeToCommit(a)},subscriptionManager:n,table:function(a){return l(u,a,function(){var b=new Map();return{entries:function(b,c,d){c===void 0&&(c="asc");return j(z(g.createTransaction("readonly"),b,a,void 0,c,d),t)},get:function(b,c){c===void 0&&(c=new WeakMap());return t.chainPromiseOrValue(function(d){return x(g.createTransaction("readonly"),c,a,void 0,b,d)})},index:function(c){return l(b,c,function(){return{entries:function(b,d,e){d===void 0&&(d="asc");return j(z(g.createTransaction("readonly"),b,a,c,d,e),t)},get:function(b,d){d===void 0&&(d=new WeakMap());return t.chainPromiseOrValue(function(e){return x(g.createTransaction("readonly"),d,a,c,b,e)})},getKey:function(b){return t.chainPromiseOrValue(function(d){return y(g.createTransaction("readonly"),new WeakMap(),a,c,b,d)})},keyLength:e.tableNames[a].indexes[c].length,subscribe:function(b,f,g){return n.subscribeIndex(a,c,b,d("ReQLBounds").extendBounds(f,e.tableNames[a].indexes[c]),g)}}})},keyLength:e.tableNames[a].primaryKeyIds.length,peekNextAutoIncrementId:function(){return t.chainPromiseOrValue(function(b){return B(g.createTransaction("readonly"),new WeakMap(),a,b)})},subscribe:function(b,c,f){return n.subscribeTable(a,b,d("ReQLBounds").extendBounds(c,e.tableNames[a].primaryKeyIds.length),f)}}})}}}function m(a,b){return c("ExecutionEnvironment").canUseDOM&&c("MetaConfig")._("27")?new Promise(function(d,e){var f=5e3;b.ref=c("setTimeout")(function(){c("FBLogger")("messenger_web_product").catching(a).blameToPreviousFrame().mustfix("ReStore transaction took longer than %s ms to execute",f.toString()),e(a)},f)}):new Promise(function(){})}a.TransactionClosedError=e;g.default=a}),98);